{"ast":null,"code":"import { onBeforeUnmount, watch, onMounted } from 'vue';\nconst SMOOTH_PTG = 14 / 15;\nexport default function useMobileTouchMove(inVirtual, listRef, callback) {\n  let touched = false;\n  let touchY = 0;\n  let element = null;\n  // Smooth scroll\n  let interval = null;\n  const cleanUpEvents = () => {\n    if (element) {\n      element.removeEventListener('touchmove', onTouchMove);\n      element.removeEventListener('touchend', onTouchEnd);\n    }\n  };\n  const onTouchMove = e => {\n    if (touched) {\n      const currentY = Math.ceil(e.touches[0].pageY);\n      let offsetY = touchY - currentY;\n      touchY = currentY;\n      if (callback(offsetY)) {\n        e.preventDefault();\n      }\n      // Smooth interval\n      clearInterval(interval);\n      interval = setInterval(() => {\n        offsetY *= SMOOTH_PTG;\n        if (!callback(offsetY, true) || Math.abs(offsetY) <= 0.1) {\n          clearInterval(interval);\n        }\n      }, 16);\n    }\n  };\n  const onTouchEnd = () => {\n    touched = false;\n    cleanUpEvents();\n  };\n  const onTouchStart = e => {\n    cleanUpEvents();\n    if (e.touches.length === 1 && !touched) {\n      touched = true;\n      touchY = Math.ceil(e.touches[0].pageY);\n      element = e.target;\n      element.addEventListener('touchmove', onTouchMove, {\n        passive: false\n      });\n      element.addEventListener('touchend', onTouchEnd);\n    }\n  };\n  const noop = () => {};\n  onMounted(() => {\n    document.addEventListener('touchmove', noop, {\n      passive: false\n    });\n    watch(inVirtual, val => {\n      listRef.value.removeEventListener('touchstart', onTouchStart);\n      cleanUpEvents();\n      clearInterval(interval);\n      if (val) {\n        listRef.value.addEventListener('touchstart', onTouchStart, {\n          passive: false\n        });\n      }\n    }, {\n      immediate: true\n    });\n  });\n  onBeforeUnmount(() => {\n    document.removeEventListener('touchmove', noop);\n  });\n}","map":{"version":3,"names":["onBeforeUnmount","watch","onMounted","SMOOTH_PTG","useMobileTouchMove","inVirtual","listRef","callback","touched","touchY","element","interval","cleanUpEvents","removeEventListener","onTouchMove","onTouchEnd","e","currentY","Math","ceil","touches","pageY","offsetY","preventDefault","clearInterval","setInterval","abs","onTouchStart","length","target","addEventListener","passive","noop","document","val","value","immediate"],"sources":["/Users/lpl/工作/Teamsupport/develop_help/node_modules/ant-design-vue/es/vc-virtual-list/hooks/useMobileTouchMove.js"],"sourcesContent":["import { onBeforeUnmount, watch, onMounted } from 'vue';\nconst SMOOTH_PTG = 14 / 15;\nexport default function useMobileTouchMove(inVirtual, listRef, callback) {\n  let touched = false;\n  let touchY = 0;\n  let element = null;\n  // Smooth scroll\n  let interval = null;\n  const cleanUpEvents = () => {\n    if (element) {\n      element.removeEventListener('touchmove', onTouchMove);\n      element.removeEventListener('touchend', onTouchEnd);\n    }\n  };\n  const onTouchMove = e => {\n    if (touched) {\n      const currentY = Math.ceil(e.touches[0].pageY);\n      let offsetY = touchY - currentY;\n      touchY = currentY;\n      if (callback(offsetY)) {\n        e.preventDefault();\n      }\n      // Smooth interval\n      clearInterval(interval);\n      interval = setInterval(() => {\n        offsetY *= SMOOTH_PTG;\n        if (!callback(offsetY, true) || Math.abs(offsetY) <= 0.1) {\n          clearInterval(interval);\n        }\n      }, 16);\n    }\n  };\n  const onTouchEnd = () => {\n    touched = false;\n    cleanUpEvents();\n  };\n  const onTouchStart = e => {\n    cleanUpEvents();\n    if (e.touches.length === 1 && !touched) {\n      touched = true;\n      touchY = Math.ceil(e.touches[0].pageY);\n      element = e.target;\n      element.addEventListener('touchmove', onTouchMove, {\n        passive: false\n      });\n      element.addEventListener('touchend', onTouchEnd);\n    }\n  };\n  const noop = () => {};\n  onMounted(() => {\n    document.addEventListener('touchmove', noop, {\n      passive: false\n    });\n    watch(inVirtual, val => {\n      listRef.value.removeEventListener('touchstart', onTouchStart);\n      cleanUpEvents();\n      clearInterval(interval);\n      if (val) {\n        listRef.value.addEventListener('touchstart', onTouchStart, {\n          passive: false\n        });\n      }\n    }, {\n      immediate: true\n    });\n  });\n  onBeforeUnmount(() => {\n    document.removeEventListener('touchmove', noop);\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}