{"ast":null,"code":"import { getValue, updateValues } from '../utils/miscUtil';\nimport { getClosingViewDate, isSameYear, isSameMonth, isSameDecade } from '../utils/dateUtil';\nimport { watchEffect, computed, ref } from 'vue';\nfunction getStartEndDistance(startDate, endDate, picker, generateConfig) {\n  const startNext = getClosingViewDate(startDate, picker, generateConfig, 1);\n  function getDistance(compareFunc) {\n    if (compareFunc(startDate, endDate)) {\n      return 'same';\n    }\n    if (compareFunc(startNext, endDate)) {\n      return 'closing';\n    }\n    return 'far';\n  }\n  switch (picker) {\n    case 'year':\n      return getDistance((start, end) => isSameDecade(generateConfig, start, end));\n    case 'quarter':\n    case 'month':\n      return getDistance((start, end) => isSameYear(generateConfig, start, end));\n    default:\n      return getDistance((start, end) => isSameMonth(generateConfig, start, end));\n  }\n}\nfunction getRangeViewDate(values, index, picker, generateConfig) {\n  const startDate = getValue(values, 0);\n  const endDate = getValue(values, 1);\n  if (index === 0) {\n    return startDate;\n  }\n  if (startDate && endDate) {\n    const distance = getStartEndDistance(startDate, endDate, picker, generateConfig);\n    switch (distance) {\n      case 'same':\n        return startDate;\n      case 'closing':\n        return startDate;\n      default:\n        return getClosingViewDate(endDate, picker, generateConfig, -1);\n    }\n  }\n  return startDate;\n}\nexport default function useRangeViewDates(_ref) {\n  let {\n    values,\n    picker,\n    defaultDates,\n    generateConfig\n  } = _ref;\n  const defaultViewDates = ref([getValue(defaultDates, 0), getValue(defaultDates, 1)]);\n  const viewDates = ref(null);\n  const startDate = computed(() => getValue(values.value, 0));\n  const endDate = computed(() => getValue(values.value, 1));\n  const getViewDate = index => {\n    // If set default view date, use it\n    if (defaultViewDates.value[index]) {\n      return defaultViewDates.value[index];\n    }\n    return getValue(viewDates.value, index) || getRangeViewDate(values.value, index, picker.value, generateConfig.value) || startDate.value || endDate.value || generateConfig.value.getNow();\n  };\n  const startViewDate = ref(null);\n  const endViewDate = ref(null);\n  watchEffect(() => {\n    startViewDate.value = getViewDate(0);\n    endViewDate.value = getViewDate(1);\n  });\n  function setViewDate(viewDate, index) {\n    if (viewDate) {\n      let newViewDates = updateValues(viewDates.value, viewDate, index);\n      // Set view date will clean up default one\n      // Should always be an array\n      defaultViewDates.value = updateValues(defaultViewDates.value, null, index) || [null, null];\n      // Reset another one when not have value\n      const anotherIndex = (index + 1) % 2;\n      if (!getValue(values.value, anotherIndex)) {\n        newViewDates = updateValues(newViewDates, viewDate, anotherIndex);\n      }\n      viewDates.value = newViewDates;\n    } else if (startDate.value || endDate.value) {\n      // Reset all when has values when `viewDate` is `null` which means from open trigger\n      viewDates.value = null;\n    }\n  }\n  return [startViewDate, endViewDate, setViewDate];\n}","map":{"version":3,"names":["getValue","updateValues","getClosingViewDate","isSameYear","isSameMonth","isSameDecade","watchEffect","computed","ref","getStartEndDistance","startDate","endDate","picker","generateConfig","startNext","getDistance","compareFunc","start","end","getRangeViewDate","values","index","distance","useRangeViewDates","_ref","defaultDates","defaultViewDates","viewDates","value","getViewDate","getNow","startViewDate","endViewDate","setViewDate","viewDate","newViewDates","anotherIndex"],"sources":["/Users/lpl/工作/Teamsupport/develop_help/node_modules/ant-design-vue/es/vc-picker/hooks/useRangeViewDates.js"],"sourcesContent":["import { getValue, updateValues } from '../utils/miscUtil';\nimport { getClosingViewDate, isSameYear, isSameMonth, isSameDecade } from '../utils/dateUtil';\nimport { watchEffect, computed, ref } from 'vue';\nfunction getStartEndDistance(startDate, endDate, picker, generateConfig) {\n  const startNext = getClosingViewDate(startDate, picker, generateConfig, 1);\n  function getDistance(compareFunc) {\n    if (compareFunc(startDate, endDate)) {\n      return 'same';\n    }\n    if (compareFunc(startNext, endDate)) {\n      return 'closing';\n    }\n    return 'far';\n  }\n  switch (picker) {\n    case 'year':\n      return getDistance((start, end) => isSameDecade(generateConfig, start, end));\n    case 'quarter':\n    case 'month':\n      return getDistance((start, end) => isSameYear(generateConfig, start, end));\n    default:\n      return getDistance((start, end) => isSameMonth(generateConfig, start, end));\n  }\n}\nfunction getRangeViewDate(values, index, picker, generateConfig) {\n  const startDate = getValue(values, 0);\n  const endDate = getValue(values, 1);\n  if (index === 0) {\n    return startDate;\n  }\n  if (startDate && endDate) {\n    const distance = getStartEndDistance(startDate, endDate, picker, generateConfig);\n    switch (distance) {\n      case 'same':\n        return startDate;\n      case 'closing':\n        return startDate;\n      default:\n        return getClosingViewDate(endDate, picker, generateConfig, -1);\n    }\n  }\n  return startDate;\n}\nexport default function useRangeViewDates(_ref) {\n  let {\n    values,\n    picker,\n    defaultDates,\n    generateConfig\n  } = _ref;\n  const defaultViewDates = ref([getValue(defaultDates, 0), getValue(defaultDates, 1)]);\n  const viewDates = ref(null);\n  const startDate = computed(() => getValue(values.value, 0));\n  const endDate = computed(() => getValue(values.value, 1));\n  const getViewDate = index => {\n    // If set default view date, use it\n    if (defaultViewDates.value[index]) {\n      return defaultViewDates.value[index];\n    }\n    return getValue(viewDates.value, index) || getRangeViewDate(values.value, index, picker.value, generateConfig.value) || startDate.value || endDate.value || generateConfig.value.getNow();\n  };\n  const startViewDate = ref(null);\n  const endViewDate = ref(null);\n  watchEffect(() => {\n    startViewDate.value = getViewDate(0);\n    endViewDate.value = getViewDate(1);\n  });\n  function setViewDate(viewDate, index) {\n    if (viewDate) {\n      let newViewDates = updateValues(viewDates.value, viewDate, index);\n      // Set view date will clean up default one\n      // Should always be an array\n      defaultViewDates.value = updateValues(defaultViewDates.value, null, index) || [null, null];\n      // Reset another one when not have value\n      const anotherIndex = (index + 1) % 2;\n      if (!getValue(values.value, anotherIndex)) {\n        newViewDates = updateValues(newViewDates, viewDate, anotherIndex);\n      }\n      viewDates.value = newViewDates;\n    } else if (startDate.value || endDate.value) {\n      // Reset all when has values when `viewDate` is `null` which means from open trigger\n      viewDates.value = null;\n    }\n  }\n  return [startViewDate, endViewDate, setViewDate];\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}