{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { isRef, unref, computed, defineComponent, shallowRef, watch } from 'vue';\nimport { withConfirm, withError, withInfo, withSuccess, withWarn } from '../confirm';\nimport HookModal from './HookModal';\nimport destroyFns from '../destroyFns';\nlet uuid = 0;\nconst ElementsHolder = defineComponent({\n  name: 'ElementsHolder',\n  inheritAttrs: false,\n  setup(_, _ref) {\n    let {\n      expose\n    } = _ref;\n    const modals = shallowRef([]);\n    const addModal = modal => {\n      modals.value.push(modal);\n      modals.value = modals.value.slice();\n      return () => {\n        modals.value = modals.value.filter(currentModal => currentModal !== modal);\n      };\n    };\n    expose({\n      addModal\n    });\n    return () => {\n      return modals.value.map(modal => modal());\n    };\n  }\n});\nfunction useModal() {\n  const holderRef = shallowRef(null);\n  // ========================== Effect ==========================\n  const actionQueue = shallowRef([]);\n  watch(actionQueue, () => {\n    if (actionQueue.value.length) {\n      const cloneQueue = [...actionQueue.value];\n      cloneQueue.forEach(action => {\n        action();\n      });\n      actionQueue.value = [];\n    }\n  }, {\n    immediate: true\n  });\n  // =========================== Hook ===========================\n  const getConfirmFunc = withFunc => function hookConfirm(config) {\n    var _a;\n    uuid += 1;\n    const open = shallowRef(true);\n    const modalRef = shallowRef(null);\n    const configRef = shallowRef(unref(config));\n    const updateConfig = shallowRef({});\n    watch(() => config, val => {\n      updateAction(_extends(_extends({}, isRef(val) ? val.value : val), updateConfig.value));\n    });\n    const destroyAction = function () {\n      open.value = false;\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      const triggerCancel = args.some(param => param && param.triggerCancel);\n      if (configRef.value.onCancel && triggerCancel) {\n        configRef.value.onCancel(() => {}, ...args.slice(1));\n      }\n    };\n    // eslint-disable-next-line prefer-const\n    let closeFunc;\n    const modal = () => _createVNode(HookModal, {\n      \"key\": `modal-${uuid}`,\n      \"config\": withFunc(configRef.value),\n      \"ref\": modalRef,\n      \"open\": open.value,\n      \"destroyAction\": destroyAction,\n      \"afterClose\": () => {\n        closeFunc === null || closeFunc === void 0 ? void 0 : closeFunc();\n      }\n    }, null);\n    closeFunc = (_a = holderRef.value) === null || _a === void 0 ? void 0 : _a.addModal(modal);\n    if (closeFunc) {\n      destroyFns.push(closeFunc);\n    }\n    const updateAction = newConfig => {\n      configRef.value = _extends(_extends({}, configRef.value), newConfig);\n    };\n    const destroy = () => {\n      if (modalRef.value) {\n        destroyAction();\n      } else {\n        actionQueue.value = [...actionQueue.value, destroyAction];\n      }\n    };\n    const update = newConfig => {\n      updateConfig.value = newConfig;\n      if (modalRef.value) {\n        updateAction(newConfig);\n      } else {\n        actionQueue.value = [...actionQueue.value, () => updateAction(newConfig)];\n      }\n    };\n    return {\n      destroy,\n      update\n    };\n  };\n  const fns = computed(() => ({\n    info: getConfirmFunc(withInfo),\n    success: getConfirmFunc(withSuccess),\n    error: getConfirmFunc(withError),\n    warning: getConfirmFunc(withWarn),\n    confirm: getConfirmFunc(withConfirm)\n  }));\n  const holderKey = Symbol('modalHolderKey');\n  return [fns.value, () => _createVNode(ElementsHolder, {\n    \"key\": holderKey,\n    \"ref\": holderRef\n  }, null)];\n}\nexport default useModal;","map":{"version":3,"names":["_extends","createVNode","_createVNode","isRef","unref","computed","defineComponent","shallowRef","watch","withConfirm","withError","withInfo","withSuccess","withWarn","HookModal","destroyFns","uuid","ElementsHolder","name","inheritAttrs","setup","_","_ref","expose","modals","addModal","modal","value","push","slice","filter","currentModal","map","useModal","holderRef","actionQueue","length","cloneQueue","forEach","action","immediate","getConfirmFunc","withFunc","hookConfirm","config","_a","open","modalRef","configRef","updateConfig","val","updateAction","destroyAction","_len","arguments","args","Array","_key","triggerCancel","some","param","onCancel","closeFunc","afterClose","newConfig","destroy","update","fns","info","success","error","warning","confirm","holderKey","Symbol"],"sources":["/Users/lpl/工作/Teamsupport/develop_help/node_modules/ant-design-vue/es/modal/useModal/index.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { isRef, unref, computed, defineComponent, shallowRef, watch } from 'vue';\nimport { withConfirm, withError, withInfo, withSuccess, withWarn } from '../confirm';\nimport HookModal from './HookModal';\nimport destroyFns from '../destroyFns';\nlet uuid = 0;\nconst ElementsHolder = defineComponent({\n  name: 'ElementsHolder',\n  inheritAttrs: false,\n  setup(_, _ref) {\n    let {\n      expose\n    } = _ref;\n    const modals = shallowRef([]);\n    const addModal = modal => {\n      modals.value.push(modal);\n      modals.value = modals.value.slice();\n      return () => {\n        modals.value = modals.value.filter(currentModal => currentModal !== modal);\n      };\n    };\n    expose({\n      addModal\n    });\n    return () => {\n      return modals.value.map(modal => modal());\n    };\n  }\n});\nfunction useModal() {\n  const holderRef = shallowRef(null);\n  // ========================== Effect ==========================\n  const actionQueue = shallowRef([]);\n  watch(actionQueue, () => {\n    if (actionQueue.value.length) {\n      const cloneQueue = [...actionQueue.value];\n      cloneQueue.forEach(action => {\n        action();\n      });\n      actionQueue.value = [];\n    }\n  }, {\n    immediate: true\n  });\n  // =========================== Hook ===========================\n  const getConfirmFunc = withFunc => function hookConfirm(config) {\n    var _a;\n    uuid += 1;\n    const open = shallowRef(true);\n    const modalRef = shallowRef(null);\n    const configRef = shallowRef(unref(config));\n    const updateConfig = shallowRef({});\n    watch(() => config, val => {\n      updateAction(_extends(_extends({}, isRef(val) ? val.value : val), updateConfig.value));\n    });\n    const destroyAction = function () {\n      open.value = false;\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      const triggerCancel = args.some(param => param && param.triggerCancel);\n      if (configRef.value.onCancel && triggerCancel) {\n        configRef.value.onCancel(() => {}, ...args.slice(1));\n      }\n    };\n    // eslint-disable-next-line prefer-const\n    let closeFunc;\n    const modal = () => _createVNode(HookModal, {\n      \"key\": `modal-${uuid}`,\n      \"config\": withFunc(configRef.value),\n      \"ref\": modalRef,\n      \"open\": open.value,\n      \"destroyAction\": destroyAction,\n      \"afterClose\": () => {\n        closeFunc === null || closeFunc === void 0 ? void 0 : closeFunc();\n      }\n    }, null);\n    closeFunc = (_a = holderRef.value) === null || _a === void 0 ? void 0 : _a.addModal(modal);\n    if (closeFunc) {\n      destroyFns.push(closeFunc);\n    }\n    const updateAction = newConfig => {\n      configRef.value = _extends(_extends({}, configRef.value), newConfig);\n    };\n    const destroy = () => {\n      if (modalRef.value) {\n        destroyAction();\n      } else {\n        actionQueue.value = [...actionQueue.value, destroyAction];\n      }\n    };\n    const update = newConfig => {\n      updateConfig.value = newConfig;\n      if (modalRef.value) {\n        updateAction(newConfig);\n      } else {\n        actionQueue.value = [...actionQueue.value, () => updateAction(newConfig)];\n      }\n    };\n    return {\n      destroy,\n      update\n    };\n  };\n  const fns = computed(() => ({\n    info: getConfirmFunc(withInfo),\n    success: getConfirmFunc(withSuccess),\n    error: getConfirmFunc(withError),\n    warning: getConfirmFunc(withWarn),\n    confirm: getConfirmFunc(withConfirm)\n  }));\n  const holderKey = Symbol('modalHolderKey');\n  return [fns.value, () => _createVNode(ElementsHolder, {\n    \"key\": holderKey,\n    \"ref\": holderRef\n  }, null)];\n}\nexport default useModal;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}