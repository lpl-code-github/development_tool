{"ast":null,"code":"export default {\n  name: \"AddTag\",\n  props: {\n    openFlag: {\n      type: Boolean,\n      required: true\n    }\n  },\n  data() {\n    return {\n      loading: false,\n      // modal按钮的loading\n      visible: false,\n      // modal可见开关\n      childrenModelRules: {\n        name: [{\n          required: true,\n          message: '请输入标签内容',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 20,\n          message: '长度必须在 1 ～ 20',\n          trigger: 'blur'\n        }]\n      },\n      // 子modal的校验规则\n      newTag: {\n        name: \"\",\n        color: '#61afd1'\n      } // 新标签的form modal中的默认值\n    };\n  },\n\n  watch: {\n    openFlag: {\n      handler: function (newVal, oldVal) {\n        this.visible = newVal;\n      },\n      // 深度观察监听\n      deep: true\n    }\n  },\n  mounted() {\n    this.visible = this.openFlag;\n  },\n  methods: {\n    // 添加一个新标签的请求\n    addTag() {\n      this.$refs.ruleForms.validate(valid => {\n        if (valid) {\n          var data = {\n            data: this.newTag\n          };\n          this.$request.postTags(data).then(res => {\n            if (res.status === 200) {\n              this.$message.success(\"添加标签成功\");\n              // 请求成功后 将新的数据添加到tags 并关闭modal\n              this.$emit('updateModelStatus', false);\n              this.$emit('submit', res.data.data);\n            } else {\n              this.$message.error(\"添加标签失败\");\n            }\n          });\n          this.initTagFormData();\n        } else {\n          return false;\n        }\n      });\n    },\n    // 重置添加新标签的子modal\n    initTagFormData() {\n      this.$refs.ruleForms.resetFields();\n    },\n    /*\n      向父组件传值：组件状态\n     */\n    handleCancel(e) {\n      this.$emit('updateModelStatus', false);\n      this.initTagFormData();\n    },\n    afterClose(e) {\n      this.$emit('updateModelStatus', false);\n      this.initTagFormData();\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}