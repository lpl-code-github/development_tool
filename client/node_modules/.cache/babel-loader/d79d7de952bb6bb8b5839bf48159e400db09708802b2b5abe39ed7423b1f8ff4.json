{"ast":null,"code":"import { onUnmounted, watch, ref } from 'vue';\nimport wrapperRaf from '../../_util/raf';\nexport default function useHeights(mergedData, getKey, onItemAdd, onItemRemove) {\n  const instance = new Map();\n  const heights = new Map();\n  const updatedMark = ref(Symbol('update'));\n  watch(mergedData, () => {\n    updatedMark.value = Symbol('update');\n  });\n  let collectRaf = undefined;\n  function cancelRaf() {\n    wrapperRaf.cancel(collectRaf);\n  }\n  function collectHeight() {\n    cancelRaf();\n    collectRaf = wrapperRaf(() => {\n      instance.forEach((element, key) => {\n        if (element && element.offsetParent) {\n          const {\n            offsetHeight\n          } = element;\n          if (heights.get(key) !== offsetHeight) {\n            //changed = true;\n            updatedMark.value = Symbol('update');\n            heights.set(key, element.offsetHeight);\n          }\n        }\n      });\n    });\n  }\n  function setInstance(item, ins) {\n    const key = getKey(item);\n    const origin = instance.get(key);\n    if (ins) {\n      instance.set(key, ins.$el || ins);\n      collectHeight();\n    } else {\n      instance.delete(key);\n    }\n    // Instance changed\n    if (!origin !== !ins) {\n      if (ins) {\n        onItemAdd === null || onItemAdd === void 0 ? void 0 : onItemAdd(item);\n      } else {\n        onItemRemove === null || onItemRemove === void 0 ? void 0 : onItemRemove(item);\n      }\n    }\n  }\n  onUnmounted(() => {\n    cancelRaf();\n  });\n  return [setInstance, collectHeight, heights, updatedMark];\n}","map":{"version":3,"names":["onUnmounted","watch","ref","wrapperRaf","useHeights","mergedData","getKey","onItemAdd","onItemRemove","instance","Map","heights","updatedMark","Symbol","value","collectRaf","undefined","cancelRaf","cancel","collectHeight","forEach","element","key","offsetParent","offsetHeight","get","set","setInstance","item","ins","origin","$el","delete"],"sources":["/Users/lpl/工作/Teamsupport/develop_help/node_modules/ant-design-vue/es/vc-virtual-list/hooks/useHeights.js"],"sourcesContent":["import { onUnmounted, watch, ref } from 'vue';\nimport wrapperRaf from '../../_util/raf';\nexport default function useHeights(mergedData, getKey, onItemAdd, onItemRemove) {\n  const instance = new Map();\n  const heights = new Map();\n  const updatedMark = ref(Symbol('update'));\n  watch(mergedData, () => {\n    updatedMark.value = Symbol('update');\n  });\n  let collectRaf = undefined;\n  function cancelRaf() {\n    wrapperRaf.cancel(collectRaf);\n  }\n  function collectHeight() {\n    cancelRaf();\n    collectRaf = wrapperRaf(() => {\n      instance.forEach((element, key) => {\n        if (element && element.offsetParent) {\n          const {\n            offsetHeight\n          } = element;\n          if (heights.get(key) !== offsetHeight) {\n            //changed = true;\n            updatedMark.value = Symbol('update');\n            heights.set(key, element.offsetHeight);\n          }\n        }\n      });\n    });\n  }\n  function setInstance(item, ins) {\n    const key = getKey(item);\n    const origin = instance.get(key);\n    if (ins) {\n      instance.set(key, ins.$el || ins);\n      collectHeight();\n    } else {\n      instance.delete(key);\n    }\n    // Instance changed\n    if (!origin !== !ins) {\n      if (ins) {\n        onItemAdd === null || onItemAdd === void 0 ? void 0 : onItemAdd(item);\n      } else {\n        onItemRemove === null || onItemRemove === void 0 ? void 0 : onItemRemove(item);\n      }\n    }\n  }\n  onUnmounted(() => {\n    cancelRaf();\n  });\n  return [setInstance, collectHeight, heights, updatedMark];\n}"],"mappings":"AAAA,SAASA,WAAW,EAAEC,KAAK,EAAEC,GAAG,QAAQ,KAAK;AAC7C,OAAOC,UAAU,MAAM,iBAAiB;AACxC,eAAe,SAASC,UAAUA,CAACC,UAAU,EAAEC,MAAM,EAAEC,SAAS,EAAEC,YAAY,EAAE;EAC9E,MAAMC,QAAQ,GAAG,IAAIC,GAAG,CAAC,CAAC;EAC1B,MAAMC,OAAO,GAAG,IAAID,GAAG,CAAC,CAAC;EACzB,MAAME,WAAW,GAAGV,GAAG,CAACW,MAAM,CAAC,QAAQ,CAAC,CAAC;EACzCZ,KAAK,CAACI,UAAU,EAAE,MAAM;IACtBO,WAAW,CAACE,KAAK,GAAGD,MAAM,CAAC,QAAQ,CAAC;EACtC,CAAC,CAAC;EACF,IAAIE,UAAU,GAAGC,SAAS;EAC1B,SAASC,SAASA,CAAA,EAAG;IACnBd,UAAU,CAACe,MAAM,CAACH,UAAU,CAAC;EAC/B;EACA,SAASI,aAAaA,CAAA,EAAG;IACvBF,SAAS,CAAC,CAAC;IACXF,UAAU,GAAGZ,UAAU,CAAC,MAAM;MAC5BM,QAAQ,CAACW,OAAO,CAAC,CAACC,OAAO,EAAEC,GAAG,KAAK;QACjC,IAAID,OAAO,IAAIA,OAAO,CAACE,YAAY,EAAE;UACnC,MAAM;YACJC;UACF,CAAC,GAAGH,OAAO;UACX,IAAIV,OAAO,CAACc,GAAG,CAACH,GAAG,CAAC,KAAKE,YAAY,EAAE;YACrC;YACAZ,WAAW,CAACE,KAAK,GAAGD,MAAM,CAAC,QAAQ,CAAC;YACpCF,OAAO,CAACe,GAAG,CAACJ,GAAG,EAAED,OAAO,CAACG,YAAY,CAAC;UACxC;QACF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EACA,SAASG,WAAWA,CAACC,IAAI,EAAEC,GAAG,EAAE;IAC9B,MAAMP,GAAG,GAAGhB,MAAM,CAACsB,IAAI,CAAC;IACxB,MAAME,MAAM,GAAGrB,QAAQ,CAACgB,GAAG,CAACH,GAAG,CAAC;IAChC,IAAIO,GAAG,EAAE;MACPpB,QAAQ,CAACiB,GAAG,CAACJ,GAAG,EAAEO,GAAG,CAACE,GAAG,IAAIF,GAAG,CAAC;MACjCV,aAAa,CAAC,CAAC;IACjB,CAAC,MAAM;MACLV,QAAQ,CAACuB,MAAM,CAACV,GAAG,CAAC;IACtB;IACA;IACA,IAAI,CAACQ,MAAM,KAAK,CAACD,GAAG,EAAE;MACpB,IAAIA,GAAG,EAAE;QACPtB,SAAS,KAAK,IAAI,IAAIA,SAAS,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,SAAS,CAACqB,IAAI,CAAC;MACvE,CAAC,MAAM;QACLpB,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACoB,IAAI,CAAC;MAChF;IACF;EACF;EACA5B,WAAW,CAAC,MAAM;IAChBiB,SAAS,CAAC,CAAC;EACb,CAAC,CAAC;EACF,OAAO,CAACU,WAAW,EAAER,aAAa,EAAER,OAAO,EAAEC,WAAW,CAAC;AAC3D"},"metadata":{},"sourceType":"module","externalDependencies":[]}