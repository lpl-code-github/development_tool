{"ast":null,"code":"import { computed, watchEffect, onMounted, watch, onBeforeUnmount } from 'vue';\nimport { isInViewPort } from '../util';\nimport useState from '../../_util/hooks/useState';\nexport default function useTarget(target, open, gap, scrollIntoViewOptions) {\n  // ========================= Target =========================\n  // We trade `undefined` as not get target by function yet.\n  // `null` as empty target.\n  const [targetElement, setTargetElement] = useState(undefined);\n  watchEffect(() => {\n    const nextElement = typeof target.value === 'function' ? target.value() : target.value;\n    setTargetElement(nextElement || null);\n  }, {\n    flush: 'post'\n  });\n  // ========================= Align ==========================\n  const [posInfo, setPosInfo] = useState(null);\n  const updatePos = () => {\n    if (!open.value) {\n      setPosInfo(null);\n      return;\n    }\n    if (targetElement.value) {\n      // Exist target element. We should scroll and get target position\n      if (!isInViewPort(targetElement.value) && open.value) {\n        targetElement.value.scrollIntoView(scrollIntoViewOptions.value);\n      }\n      const {\n        left,\n        top,\n        width,\n        height\n      } = targetElement.value.getBoundingClientRect();\n      const nextPosInfo = {\n        left,\n        top,\n        width,\n        height,\n        radius: 0\n      };\n      if (JSON.stringify(posInfo.value) !== JSON.stringify(nextPosInfo)) {\n        setPosInfo(nextPosInfo);\n      }\n    } else {\n      // Not exist target which means we just show in center\n      setPosInfo(null);\n    }\n  };\n  onMounted(() => {\n    watch([open, targetElement], () => {\n      updatePos();\n    }, {\n      flush: 'post',\n      immediate: true\n    });\n    // update when window resize\n    window.addEventListener('resize', updatePos);\n  });\n  onBeforeUnmount(() => {\n    window.removeEventListener('resize', updatePos);\n  });\n  // ======================== PosInfo =========================\n  const mergedPosInfo = computed(() => {\n    var _a, _b;\n    if (!posInfo.value) {\n      return posInfo.value;\n    }\n    const gapOffset = ((_a = gap.value) === null || _a === void 0 ? void 0 : _a.offset) || 6;\n    const gapRadius = ((_b = gap.value) === null || _b === void 0 ? void 0 : _b.radius) || 2;\n    return {\n      left: posInfo.value.left - gapOffset,\n      top: posInfo.value.top - gapOffset,\n      width: posInfo.value.width + gapOffset * 2,\n      height: posInfo.value.height + gapOffset * 2,\n      radius: gapRadius\n    };\n  });\n  return [mergedPosInfo, targetElement];\n}","map":{"version":3,"names":["computed","watchEffect","onMounted","watch","onBeforeUnmount","isInViewPort","useState","useTarget","target","open","gap","scrollIntoViewOptions","targetElement","setTargetElement","undefined","nextElement","value","flush","posInfo","setPosInfo","updatePos","scrollIntoView","left","top","width","height","getBoundingClientRect","nextPosInfo","radius","JSON","stringify","immediate","window","addEventListener","removeEventListener","mergedPosInfo","_a","_b","gapOffset","offset","gapRadius"],"sources":["/Users/lpl/工作/Teamsupport/develop_help/node_modules/ant-design-vue/es/vc-tour/hooks/useTarget.js"],"sourcesContent":["import { computed, watchEffect, onMounted, watch, onBeforeUnmount } from 'vue';\nimport { isInViewPort } from '../util';\nimport useState from '../../_util/hooks/useState';\nexport default function useTarget(target, open, gap, scrollIntoViewOptions) {\n  // ========================= Target =========================\n  // We trade `undefined` as not get target by function yet.\n  // `null` as empty target.\n  const [targetElement, setTargetElement] = useState(undefined);\n  watchEffect(() => {\n    const nextElement = typeof target.value === 'function' ? target.value() : target.value;\n    setTargetElement(nextElement || null);\n  }, {\n    flush: 'post'\n  });\n  // ========================= Align ==========================\n  const [posInfo, setPosInfo] = useState(null);\n  const updatePos = () => {\n    if (!open.value) {\n      setPosInfo(null);\n      return;\n    }\n    if (targetElement.value) {\n      // Exist target element. We should scroll and get target position\n      if (!isInViewPort(targetElement.value) && open.value) {\n        targetElement.value.scrollIntoView(scrollIntoViewOptions.value);\n      }\n      const {\n        left,\n        top,\n        width,\n        height\n      } = targetElement.value.getBoundingClientRect();\n      const nextPosInfo = {\n        left,\n        top,\n        width,\n        height,\n        radius: 0\n      };\n      if (JSON.stringify(posInfo.value) !== JSON.stringify(nextPosInfo)) {\n        setPosInfo(nextPosInfo);\n      }\n    } else {\n      // Not exist target which means we just show in center\n      setPosInfo(null);\n    }\n  };\n  onMounted(() => {\n    watch([open, targetElement], () => {\n      updatePos();\n    }, {\n      flush: 'post',\n      immediate: true\n    });\n    // update when window resize\n    window.addEventListener('resize', updatePos);\n  });\n  onBeforeUnmount(() => {\n    window.removeEventListener('resize', updatePos);\n  });\n  // ======================== PosInfo =========================\n  const mergedPosInfo = computed(() => {\n    var _a, _b;\n    if (!posInfo.value) {\n      return posInfo.value;\n    }\n    const gapOffset = ((_a = gap.value) === null || _a === void 0 ? void 0 : _a.offset) || 6;\n    const gapRadius = ((_b = gap.value) === null || _b === void 0 ? void 0 : _b.radius) || 2;\n    return {\n      left: posInfo.value.left - gapOffset,\n      top: posInfo.value.top - gapOffset,\n      width: posInfo.value.width + gapOffset * 2,\n      height: posInfo.value.height + gapOffset * 2,\n      radius: gapRadius\n    };\n  });\n  return [mergedPosInfo, targetElement];\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}