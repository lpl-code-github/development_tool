{"ast":null,"code":"import Markdown from \"@/components/code/Markdown\";\nimport { getSlateDoc } from \"@/api/request\";\nexport default {\n  name: 'SlateGenerator',\n  components: {\n    Markdown\n  },\n  data() {\n    return {\n      componentKey: 0,\n      docContent: \"\",\n      loading: false,\n      buttonConfirmIsDisabled: true,\n      controllerLists: [],\n      selectedController: null,\n      existSelectController: false\n    };\n  },\n  created() {\n    this.$bus.$on('markdownInput', newVal => {\n      this.docContent = newVal;\n      if (newVal === \"\") {\n        sessionStorage.removeItem(\"selected_controller\");\n      }\n    });\n    this.getControllerLists();\n  },\n  mounted() {\n    var editDoc = sessionStorage.getItem(\"edit_doc\");\n    if (editDoc !== null && editDoc !== \"\") {\n      this.docContent = editDoc;\n    }\n    var selectedController = sessionStorage.getItem(\"selected_controller\");\n    if (selectedController !== null && selectedController !== \"\") {\n      if (editDoc !== null && editDoc === \"\") {\n        this.docContent = editDoc;\n        this.docContent = editDoc;\n        this.existSelectController = false;\n      } else {\n        this.existSelectController = true;\n        this.selectedController = selectedController;\n      }\n    }\n  },\n  methods: {\n    getControllerLists() {\n      var params = \"?type=controller\";\n      this.$request.getFileLists(params).then(res => {\n        if (res.status === 200) {\n          this.controllerLists = res.data;\n        }\n      });\n    },\n    getDefaultClick() {\n      if (this.docContent !== \"\") {\n        this.buttonConfirmIsDisabled = false;\n        return;\n      }\n      this.existSelectController = false;\n      this.selectedController = \"\";\n      this.buttonConfirmIsDisabled = true;\n      sessionStorage.removeItem(\"selected_controller\");\n      this.handleGetSlateDoc();\n    },\n    handleGetSlateDoc(controller) {\n      this.loading = true;\n      var param = \"\";\n      if (controller !== undefined) {\n        param = \"?controller=\" + controller;\n      }\n      this.$request.getSlateDoc(param).then(res => {\n        if (res.status === 200) {\n          this.docContent = res.data;\n        }\n        this.loading = false;\n      });\n    },\n    confirm(e) {\n      this.handleGetSlateDoc();\n      this.componentKey += 1;\n      this.existSelectController = false;\n      sessionStorage.removeItem(\"selected_controller\");\n    },\n    cancel(e) {},\n    filterOption(input, option) {\n      return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n    },\n    handleSelect(value, option) {\n      sessionStorage.setItem(\"selected_controller\", value);\n      if (this.docContent !== \"\") {\n        var confirm = this.$confirm({\n          title: '提示',\n          content: '编辑器中还有内容，确认生成新的文档吗？',\n          okText: '确认',\n          cancelText: '取消',\n          onOk: () => {\n            // 使用箭头函数来保持this的指向\n            this.existSelectController = true;\n            this.selectedController = value;\n            this.handleGetSlateDoc(value);\n            confirm.destroy();\n          },\n          onCancel() {\n            confirm.destroy();\n          }\n        });\n        return;\n      }\n      this.existSelectController = true;\n      this.selectedController = value;\n      this.handleGetSlateDoc(value);\n    }\n  }\n};","map":{"version":3,"names":["Markdown","getSlateDoc","name","components","data","componentKey","docContent","loading","buttonConfirmIsDisabled","controllerLists","selectedController","existSelectController","created","$bus","$on","newVal","sessionStorage","removeItem","getControllerLists","mounted","editDoc","getItem","methods","params","$request","getFileLists","then","res","status","getDefaultClick","handleGetSlateDoc","controller","param","undefined","confirm","e","cancel","filterOption","input","option","componentOptions","children","text","toLowerCase","indexOf","handleSelect","value","setItem","$confirm","title","content","okText","cancelText","onOk","destroy","onCancel"],"sources":["src/views/SlateGenerator.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin-top: 20px;display: flex;justify-content: space-between\">\n\n      <a-select\n          show-search\n          placeholder=\"选择Controller\"\n          option-filter-prop=\"children\"\n          style=\"width: 200px;\"\n          :filter-option=\"filterOption\"\n          @select=\"handleSelect\"\n          :key=\"componentKey\"\n          :value=\"existSelectController ? selectedController : undefined\"\n      >\n        <a-select-option v-for=\"(item,index) in controllerLists\" :key=\"index\" :value=\"item\">\n          {{ item }}\n        </a-select-option>\n      </a-select>\n\n\n      <a-popconfirm\n          placement=\"leftTop\"\n          style=\"z-index: 99999!important;\"\n          title=\"编辑器中还有内容，确认获取默认模版吗？\"\n          ok-text=\"Yes\"\n          cancel-text=\"No\"\n          @confirm=\"confirm\"\n          @cancel=\"cancel\"\n          :disabled=\"buttonConfirmIsDisabled\"\n      >\n        <a-button @click=\"getDefaultClick\">获取默认模版</a-button>\n      </a-popconfirm>\n    </div>\n\n    <a-spin size=\"large\" :spinning=\"loading\">\n      <Markdown style=\"z-index: -1!important;\" :doc-content=\"docContent\"></Markdown>\n    </a-spin>\n\n  </div>\n</template>\n\n<script>\nimport Markdown from \"@/components/code/Markdown\";\nimport {getSlateDoc} from \"@/api/request\";\n\nexport default {\n  name: 'SlateGenerator',\n  components: {Markdown},\n  data() {\n    return {\n      componentKey: 0,\n      docContent: \"\",\n      loading: false,\n      buttonConfirmIsDisabled: true,\n      controllerLists: [],\n      selectedController: null,\n      existSelectController: false\n    }\n  },\n  created() {\n    this.$bus.$on('markdownInput', (newVal) => {\n      this.docContent = newVal\n      if (newVal === \"\") {\n        sessionStorage.removeItem(\"selected_controller\")\n      }\n    });\n    this.getControllerLists()\n\n  },\n  mounted() {\n    var editDoc = sessionStorage.getItem(\"edit_doc\");\n    if (editDoc !== null && editDoc !== \"\") {\n      this.docContent = editDoc\n\n    }\n\n    var selectedController = sessionStorage.getItem(\"selected_controller\");\n    if (selectedController !== null && selectedController !== \"\") {\n      if (editDoc !== null && editDoc === \"\") {\n        this.docContent = editDoc\n        this.docContent = editDoc\n        this.existSelectController = false\n      } else {\n        this.existSelectController = true\n        this.selectedController = selectedController\n      }\n    }\n  },\n  methods: {\n    getControllerLists() {\n      var params = \"?type=controller\"\n      this.$request.getFileLists(params).then(res => {\n        if (res.status === 200) {\n          this.controllerLists = res.data\n        }\n      })\n    },\n    getDefaultClick() {\n      if (this.docContent !== \"\") {\n        this.buttonConfirmIsDisabled = false\n        return\n      }\n      this.existSelectController = false\n      this.selectedController = \"\"\n      this.buttonConfirmIsDisabled = true\n      sessionStorage.removeItem(\"selected_controller\");\n      this.handleGetSlateDoc()\n    },\n    handleGetSlateDoc(controller) {\n      this.loading = true\n      var param = \"\"\n      if (controller !== undefined) {\n        param = \"?controller=\" + controller\n      }\n      this.$request.getSlateDoc(param).then(res => {\n        if (res.status === 200) {\n          this.docContent = res.data\n        }\n        this.loading = false\n      })\n    },\n    confirm(e) {\n      this.handleGetSlateDoc()\n      this.componentKey += 1\n      this.existSelectController = false\n      sessionStorage.removeItem(\"selected_controller\")\n    },\n    cancel(e) {\n    },\n    filterOption(input, option) {\n      return (\n          option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n      );\n    },\n    handleSelect(value, option) {\n      sessionStorage.setItem(\"selected_controller\", value)\n      if (this.docContent !== \"\") {\n        var confirm = this.$confirm({\n          title: '提示',\n          content: '编辑器中还有内容，确认生成新的文档吗？',\n          okText: '确认',\n          cancelText: '取消',\n          onOk: () => { // 使用箭头函数来保持this的指向\n            this.existSelectController = true\n            this.selectedController = value\n            this.handleGetSlateDoc(value)\n            confirm.destroy();\n          },\n          onCancel() {\n            confirm.destroy();\n          },\n        });\n        return\n      }\n      this.existSelectController = true\n      this.selectedController = value\n      this.handleGetSlateDoc(value)\n    }\n  }\n};\n</script>\n<style scoped>\n\n.my-title {\n  font-size: 15px\n}\n</style>\n"],"mappings":"AA0CA,OAAAA,QAAA;AACA,SAAAC,WAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAH;EAAA;EACAI,KAAA;IACA;MACAC,YAAA;MACAC,UAAA;MACAC,OAAA;MACAC,uBAAA;MACAC,eAAA;MACAC,kBAAA;MACAC,qBAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA,CAAAC,GAAA,kBAAAC,MAAA;MACA,KAAAT,UAAA,GAAAS,MAAA;MACA,IAAAA,MAAA;QACAC,cAAA,CAAAC,UAAA;MACA;IACA;IACA,KAAAC,kBAAA;EAEA;EACAC,QAAA;IACA,IAAAC,OAAA,GAAAJ,cAAA,CAAAK,OAAA;IACA,IAAAD,OAAA,aAAAA,OAAA;MACA,KAAAd,UAAA,GAAAc,OAAA;IAEA;IAEA,IAAAV,kBAAA,GAAAM,cAAA,CAAAK,OAAA;IACA,IAAAX,kBAAA,aAAAA,kBAAA;MACA,IAAAU,OAAA,aAAAA,OAAA;QACA,KAAAd,UAAA,GAAAc,OAAA;QACA,KAAAd,UAAA,GAAAc,OAAA;QACA,KAAAT,qBAAA;MACA;QACA,KAAAA,qBAAA;QACA,KAAAD,kBAAA,GAAAA,kBAAA;MACA;IACA;EACA;EACAY,OAAA;IACAJ,mBAAA;MACA,IAAAK,MAAA;MACA,KAAAC,QAAA,CAAAC,YAAA,CAAAF,MAAA,EAAAG,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,MAAA;UACA,KAAAnB,eAAA,GAAAkB,GAAA,CAAAvB,IAAA;QACA;MACA;IACA;IACAyB,gBAAA;MACA,SAAAvB,UAAA;QACA,KAAAE,uBAAA;QACA;MACA;MACA,KAAAG,qBAAA;MACA,KAAAD,kBAAA;MACA,KAAAF,uBAAA;MACAQ,cAAA,CAAAC,UAAA;MACA,KAAAa,iBAAA;IACA;IACAA,kBAAAC,UAAA;MACA,KAAAxB,OAAA;MACA,IAAAyB,KAAA;MACA,IAAAD,UAAA,KAAAE,SAAA;QACAD,KAAA,oBAAAD,UAAA;MACA;MACA,KAAAP,QAAA,CAAAvB,WAAA,CAAA+B,KAAA,EAAAN,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,MAAA;UACA,KAAAtB,UAAA,GAAAqB,GAAA,CAAAvB,IAAA;QACA;QACA,KAAAG,OAAA;MACA;IACA;IACA2B,QAAAC,CAAA;MACA,KAAAL,iBAAA;MACA,KAAAzB,YAAA;MACA,KAAAM,qBAAA;MACAK,cAAA,CAAAC,UAAA;IACA;IACAmB,OAAAD,CAAA,GACA;IACAE,aAAAC,KAAA,EAAAC,MAAA;MACA,OACAA,MAAA,CAAAC,gBAAA,CAAAC,QAAA,IAAAC,IAAA,CAAAC,WAAA,GAAAC,OAAA,CAAAN,KAAA,CAAAK,WAAA;IAEA;IACAE,aAAAC,KAAA,EAAAP,MAAA;MACAvB,cAAA,CAAA+B,OAAA,wBAAAD,KAAA;MACA,SAAAxC,UAAA;QACA,IAAA4B,OAAA,QAAAc,QAAA;UACAC,KAAA;UACAC,OAAA;UACAC,MAAA;UACAC,UAAA;UACAC,IAAA,EAAAA,CAAA;YAAA;YACA,KAAA1C,qBAAA;YACA,KAAAD,kBAAA,GAAAoC,KAAA;YACA,KAAAhB,iBAAA,CAAAgB,KAAA;YACAZ,OAAA,CAAAoB,OAAA;UACA;UACAC,SAAA;YACArB,OAAA,CAAAoB,OAAA;UACA;QACA;QACA;MACA;MACA,KAAA3C,qBAAA;MACA,KAAAD,kBAAA,GAAAoC,KAAA;MACA,KAAAhB,iBAAA,CAAAgB,KAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}