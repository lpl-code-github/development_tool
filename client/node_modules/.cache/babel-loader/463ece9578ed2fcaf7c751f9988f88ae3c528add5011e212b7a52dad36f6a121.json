{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AddScript from \"@/components/Script/AddScript\";\nexport default {\n  name: \"Script\",\n  components: {\n    AddScript\n  },\n  data() {\n    return {\n      columns: [{\n        title: '名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '标签',\n        key: 'tags',\n        dataIndex: 'tags',\n        filters: [],\n        scopedSlots: {\n          customRender: 'tags'\n        }\n      }, {\n        title: '路径',\n        dataIndex: 'path',\n        key: 'age'\n      }, {\n        title: '创建时间',\n        dataIndex: 'created_at',\n        key: 'address'\n      }, {\n        title: 'Action',\n        dataIndex: '',\n        key: 'x',\n        scopedSlots: {\n          customRender: 'action'\n        }\n      }],\n      // table信息\n      paginationConfig: {\n        defaultCurrent: 1,\n        defaultPageSize: 5\n      },\n      // 分页数据\n      scriptData: [],\n      tableData: [],\n      cacheData: [],\n      // 缓存数据 用于编辑表格时，缓存之前的数据\n      filteredTags: [],\n      tagsFilterDropdownVisible: false,\n      openAddScriptModel: false\n    };\n  },\n  created() {\n    this.getScriptData();\n  },\n  methods: {\n    //获取全部ScriptData\n    getScriptData(params) {\n      if (params == null) {\n        params = \"\";\n      }\n      this.$request.getScriptData(params).then(res => {\n        if (res.status === 200) {\n          if (res.status === 200) {\n            this.scriptData = res.data.data;\n            const tagsFilters = [];\n            this.scriptData.forEach(item => {\n              item.tags.forEach(tag => {\n                const existingTag = tagsFilters.find(filter => filter.text === tag.name);\n                if (!existingTag) {\n                  tagsFilters.push({\n                    text: tag.name,\n                    value: tag.name\n                  });\n                }\n              });\n            });\n            this.columns.forEach(item => {\n              if (item.key === 'tags') {\n                item.filters = tagsFilters;\n              }\n            });\n            this.tableData = this.scriptData;\n            this.cacheData = this.tableData.map(item => ({\n              ...item\n            }));\n          }\n        }\n      });\n    },\n    onSearch(value) {\n      console.log(value);\n    },\n    handleChange(pagination, filters) {\n      var tagFilterChecked = filters.tags;\n      if (filters.tags.length === 0) {\n        this.tableData = this.scriptData;\n        return;\n      }\n      this.tableData = this.scriptData.filter(item => {\n        return item.tags.some(tag => tagFilterChecked.includes(tag.text));\n      });\n    },\n    // getScriptData() {\n    //   this.scriptData = [\n    //     {\n    //       id: 1,\n    //       name: 'John Brown',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#108ee9\",\n    //           text: \"db\"\n    //         },\n    //         {\n    //           color: \"#690c3d\",\n    //           text: \"test\"\n    //         }\n    //       ],\n    //       created_at: 'New York No. 1 Lake Park',\n    //       description: 'My name is John Brown, I am 32 years old, living in New York No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 2,\n    //       name: 'Jim Green',\n    //       path: 42,\n    //       tags: [\n    //         {\n    //           color: \"#690c3d\",\n    //           text: \"test\"\n    //         }\n    //       ],\n    //       created_at: 'London No. 1 Lake Park',\n    //       description: 'My name is Jim Green, I am 42 years old, living in London No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 3,\n    //       name: 'Joe Black',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#3a9f75\",\n    //           text: \"env\"\n    //         }\n    //       ],\n    //       created_at: 'Sidney No. 1 Lake Park',\n    //       description: 'My name is Joe Black, I am 32 years old, living in Sidney No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 4,\n    //       name: 'Joe Black',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#3a9f75\",\n    //           text: \"env\"\n    //         }\n    //       ],\n    //       created_at: 'Sidney No. 1 Lake Park',\n    //       description: 'My name is Joe Black, I am 32 years old, living in Sidney No. 1 Lake Park.',\n    //     }\n    //   ]\n    //   const tagsFilters = [];\n    //\n    //   this.scriptData.forEach(item => {\n    //     item.tags.forEach(tag => {\n    //       const existingTag = tagsFilters.find(filter => filter.text === tag.text);\n    //       if (!existingTag) {\n    //         tagsFilters.push({text: tag.text, value: tag.text});\n    //       }\n    //     });\n    //   });\n    //\n    //   this.columns.forEach(item => {\n    //     if (item.key === 'tags') {\n    //       item.filters = tagsFilters\n    //     }\n    //   })\n    //   this.tableData = this.scriptData\n    // },\n    addScript() {\n      this.openAddScriptModel = true;\n    },\n    getModelStatus(status) {\n      this.openAddScriptModel = status;\n    }\n  }\n};","map":{"version":3,"names":["AddScript","name","components","data","columns","title","dataIndex","key","filters","scopedSlots","customRender","paginationConfig","defaultCurrent","defaultPageSize","scriptData","tableData","cacheData","filteredTags","tagsFilterDropdownVisible","openAddScriptModel","created","getScriptData","methods","params","$request","then","res","status","tagsFilters","forEach","item","tags","tag","existingTag","find","filter","text","push","value","map","onSearch","console","log","handleChange","pagination","tagFilterChecked","length","some","includes","addScript","getModelStatus"],"sources":["src/views/Script.vue"],"sourcesContent":["<template>\n  <div class=\"my-script\">\n    <AddScript @updateModelStatus=\"getModelStatus\" :open-flag=\"openAddScriptModel\"></AddScript>\n    <div class=\"my-s-button\">\n      <a-input-search placeholder=\"输入脚本名或描述搜索\" style=\"width: 200px\" @search=\"onSearch\"/>\n      <a-button type=\"primary\" @click=\"addScript\">\n        添加\n      </a-button>\n    </div>\n    <div class=\"my-s-table\">\n      <a-table :columns=\"columns\"\n               :data-source=\"tableData\"\n               @change=\"handleChange\"\n               :pagination=\"paginationConfig\"\n      >\n        <span slot=\"tags\" slot-scope=\"tags\">\n          <a-tag\n              v-for=\"(t,index) in tags\"\n              :key=\"index\"\n              :color=\"t.color\"\n          >\n            {{ t.name }}\n          </a-tag>\n        </span>\n        <span slot=\"action\" slot-scope=\"text, record\">\n          <a style=\"color: #2c982c\">运行</a>\n          <a-divider type=\"vertical\" style=\"background-color: #a8a7a7!important;\"/>\n          <a style=\"color: #f17878\">删除</a>\n        </span>\n        <p slot=\"expandedRowRender\" slot-scope=\"record\" style=\"margin: 0\">\n          {{ record.description }}\n        </p>\n      </a-table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport AddScript from \"@/components/Script/AddScript\";\n\nexport default {\n  name: \"Script\",\n  components: {AddScript},\n  data() {\n    return {\n      columns: [\n        {title: '名称', dataIndex: 'name', key: 'name'},\n        {\n          title: '标签',\n          key: 'tags',\n          dataIndex: 'tags',\n          filters: [],\n          scopedSlots: {customRender: 'tags'},\n        },\n        {title: '路径', dataIndex: 'path', key: 'age'},\n        {title: '创建时间', dataIndex: 'created_at', key: 'address'},\n        {title: 'Action', dataIndex: '', key: 'x', scopedSlots: {customRender: 'action'}},\n      ], // table信息\n      paginationConfig: {\n        defaultCurrent: 1,\n        defaultPageSize: 5,\n      }, // 分页数据\n      scriptData: [],\n      tableData: [],\n      cacheData: [],// 缓存数据 用于编辑表格时，缓存之前的数据\n      filteredTags: [],\n      tagsFilterDropdownVisible: false,\n      openAddScriptModel: false\n    }\n  },\n  created() {\n    this.getScriptData()\n  },\n  methods: {\n    //获取全部ScriptData\n    getScriptData(params) {\n      if (params == null) {\n        params = \"\"\n      }\n      this.$request.getScriptData(params).then(res => {\n        if (res.status === 200) {\n          if (res.status === 200) {\n            this.scriptData = res.data.data\n\n            const tagsFilters = [];\n\n            this.scriptData.forEach(item => {\n              item.tags.forEach(tag => {\n                const existingTag = tagsFilters.find(filter => filter.text === tag.name);\n                if (!existingTag) {\n                  tagsFilters.push({text: tag.name, value: tag.name});\n                }\n              });\n            });\n            this.columns.forEach(item => {\n              if (item.key === 'tags') {\n                item.filters = tagsFilters\n              }\n            })\n            this.tableData = this.scriptData\n            this.cacheData = this.tableData.map(item => ({...item}));\n          }\n        }\n      })\n    },\n\n\n    onSearch(value) {\n      console.log(value);\n    },\n    handleChange(pagination, filters) {\n      var tagFilterChecked = filters.tags\n      if (filters.tags.length === 0) {\n        this.tableData = this.scriptData\n        return\n      }\n      this.tableData = this.scriptData.filter(item => {\n        return item.tags.some(tag => tagFilterChecked.includes(tag.text));\n      })\n    },\n    // getScriptData() {\n    //   this.scriptData = [\n    //     {\n    //       id: 1,\n    //       name: 'John Brown',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#108ee9\",\n    //           text: \"db\"\n    //         },\n    //         {\n    //           color: \"#690c3d\",\n    //           text: \"test\"\n    //         }\n    //       ],\n    //       created_at: 'New York No. 1 Lake Park',\n    //       description: 'My name is John Brown, I am 32 years old, living in New York No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 2,\n    //       name: 'Jim Green',\n    //       path: 42,\n    //       tags: [\n    //         {\n    //           color: \"#690c3d\",\n    //           text: \"test\"\n    //         }\n    //       ],\n    //       created_at: 'London No. 1 Lake Park',\n    //       description: 'My name is Jim Green, I am 42 years old, living in London No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 3,\n    //       name: 'Joe Black',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#3a9f75\",\n    //           text: \"env\"\n    //         }\n    //       ],\n    //       created_at: 'Sidney No. 1 Lake Park',\n    //       description: 'My name is Joe Black, I am 32 years old, living in Sidney No. 1 Lake Park.',\n    //     },\n    //     {\n    //       id: 4,\n    //       name: 'Joe Black',\n    //       path: 32,\n    //       tags: [\n    //         {\n    //           color: \"#3a9f75\",\n    //           text: \"env\"\n    //         }\n    //       ],\n    //       created_at: 'Sidney No. 1 Lake Park',\n    //       description: 'My name is Joe Black, I am 32 years old, living in Sidney No. 1 Lake Park.',\n    //     }\n    //   ]\n    //   const tagsFilters = [];\n    //\n    //   this.scriptData.forEach(item => {\n    //     item.tags.forEach(tag => {\n    //       const existingTag = tagsFilters.find(filter => filter.text === tag.text);\n    //       if (!existingTag) {\n    //         tagsFilters.push({text: tag.text, value: tag.text});\n    //       }\n    //     });\n    //   });\n    //\n    //   this.columns.forEach(item => {\n    //     if (item.key === 'tags') {\n    //       item.filters = tagsFilters\n    //     }\n    //   })\n    //   this.tableData = this.scriptData\n    // },\n    addScript() {\n      this.openAddScriptModel = true\n    },\n\n    getModelStatus(status) {\n      this.openAddScriptModel = status\n    },\n  }\n}\n</script>\n\n<style scoped>\n.my-script {\n\n}\n\n.my-s-button {\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n}\n\n.my-s-table {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":";AAsCA,OAAAA,SAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAF;EAAA;EACAG,KAAA;IACA;MACAC,OAAA,GACA;QAAAC,KAAA;QAAAC,SAAA;QAAAC,GAAA;MAAA,GACA;QACAF,KAAA;QACAE,GAAA;QACAD,SAAA;QACAE,OAAA;QACAC,WAAA;UAAAC,YAAA;QAAA;MACA,GACA;QAAAL,KAAA;QAAAC,SAAA;QAAAC,GAAA;MAAA,GACA;QAAAF,KAAA;QAAAC,SAAA;QAAAC,GAAA;MAAA,GACA;QAAAF,KAAA;QAAAC,SAAA;QAAAC,GAAA;QAAAE,WAAA;UAAAC,YAAA;QAAA;MAAA,EACA;MAAA;MACAC,gBAAA;QACAC,cAAA;QACAC,eAAA;MACA;MAAA;MACAC,UAAA;MACAC,SAAA;MACAC,SAAA;MAAA;MACAC,YAAA;MACAC,yBAAA;MACAC,kBAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,aAAA;EACA;EACAC,OAAA;IACA;IACAD,cAAAE,MAAA;MACA,IAAAA,MAAA;QACAA,MAAA;MACA;MACA,KAAAC,QAAA,CAAAH,aAAA,CAAAE,MAAA,EAAAE,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,MAAA;UACA,IAAAD,GAAA,CAAAC,MAAA;YACA,KAAAb,UAAA,GAAAY,GAAA,CAAAvB,IAAA,CAAAA,IAAA;YAEA,MAAAyB,WAAA;YAEA,KAAAd,UAAA,CAAAe,OAAA,CAAAC,IAAA;cACAA,IAAA,CAAAC,IAAA,CAAAF,OAAA,CAAAG,GAAA;gBACA,MAAAC,WAAA,GAAAL,WAAA,CAAAM,IAAA,CAAAC,MAAA,IAAAA,MAAA,CAAAC,IAAA,KAAAJ,GAAA,CAAA/B,IAAA;gBACA,KAAAgC,WAAA;kBACAL,WAAA,CAAAS,IAAA;oBAAAD,IAAA,EAAAJ,GAAA,CAAA/B,IAAA;oBAAAqC,KAAA,EAAAN,GAAA,CAAA/B;kBAAA;gBACA;cACA;YACA;YACA,KAAAG,OAAA,CAAAyB,OAAA,CAAAC,IAAA;cACA,IAAAA,IAAA,CAAAvB,GAAA;gBACAuB,IAAA,CAAAtB,OAAA,GAAAoB,WAAA;cACA;YACA;YACA,KAAAb,SAAA,QAAAD,UAAA;YACA,KAAAE,SAAA,QAAAD,SAAA,CAAAwB,GAAA,CAAAT,IAAA;cAAA,GAAAA;YAAA;UACA;QACA;MACA;IACA;IAGAU,SAAAF,KAAA;MACAG,OAAA,CAAAC,GAAA,CAAAJ,KAAA;IACA;IACAK,aAAAC,UAAA,EAAApC,OAAA;MACA,IAAAqC,gBAAA,GAAArC,OAAA,CAAAuB,IAAA;MACA,IAAAvB,OAAA,CAAAuB,IAAA,CAAAe,MAAA;QACA,KAAA/B,SAAA,QAAAD,UAAA;QACA;MACA;MACA,KAAAC,SAAA,QAAAD,UAAA,CAAAqB,MAAA,CAAAL,IAAA;QACA,OAAAA,IAAA,CAAAC,IAAA,CAAAgB,IAAA,CAAAf,GAAA,IAAAa,gBAAA,CAAAG,QAAA,CAAAhB,GAAA,CAAAI,IAAA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAa,UAAA;MACA,KAAA9B,kBAAA;IACA;IAEA+B,eAAAvB,MAAA;MACA,KAAAR,kBAAA,GAAAQ,MAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}