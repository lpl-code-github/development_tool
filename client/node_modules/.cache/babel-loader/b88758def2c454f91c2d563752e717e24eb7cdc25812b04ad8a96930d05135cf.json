{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"AddTag\",\n  props: {\n    openFlag: {\n      type: Boolean,\n      required: true\n    }\n  },\n  data() {\n    return {\n      loading: false,\n      // modal按钮的loading\n      visible: false,\n      // modal可见开关\n      childrenModelRules: {\n        name: [{\n          required: true,\n          message: '请输入标签内容',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 20,\n          message: '长度必须在 1 ～ 20',\n          trigger: 'blur'\n        }]\n      },\n      // 子modal的校验规则\n      newTag: {\n        name: \"\",\n        color: '#61afd1'\n      } // 新标签的form modal中的默认值\n    };\n  },\n\n  watch: {\n    openFlag: {\n      handler: function (newVal, oldVal) {\n        this.visible = newVal;\n      },\n      // 深度观察监听\n      deep: true\n    }\n  },\n  mounted() {\n    this.visible = this.openFlag;\n  },\n  methods: {\n    // 添加一个新标签的请求\n    addTag() {\n      this.$refs.ruleForm.validate(valid => {\n        if (valid) {\n          var data = {\n            data: this.newTag\n          };\n          this.$request.postTags(data).then(res => {\n            if (res.status === 200) {\n              this.$message.success(\"添加标签成功\");\n              // 请求成功后 将新的数据添加到tags\n              this.tags.push(res.data.data[0]);\n            } else {\n              this.$message.error(\"添加标签失败\");\n            }\n          });\n          this.initTagFormData();\n          this.childrenModelVisible = false;\n        } else {\n          return false;\n        }\n      });\n    },\n    // 重置添加新标签的子modal\n    initTagFormData() {\n      this.$refs.ruleForm.resetFields();\n    },\n    /*\n      向父组件传值：组件状态\n     */\n    handleCancel(e) {\n      this.initTagFormData();\n      this.$emit('updateModelStatus', false);\n    },\n    afterClose(e) {\n      this.initTagFormData();\n      this.$emit('updateModelStatus', false);\n    }\n  }\n};","map":{"version":3,"names":["name","props","openFlag","type","Boolean","required","data","loading","visible","childrenModelRules","message","trigger","min","max","newTag","color","watch","handler","newVal","oldVal","deep","mounted","methods","addTag","$refs","ruleForm","validate","valid","$request","postTags","then","res","status","$message","success","tags","push","error","initTagFormData","childrenModelVisible","resetFields","handleCancel","e","$emit","afterClose"],"sources":["src/components/Script/AddTag.vue"],"sourcesContent":["<template>\n  <div>\n    <a-modal v-model=\"visible\"\n             ref=\"tagForm\"\n             title=\"添加一个新的标签\"\n             ok-text=\"确认\"\n             cancel-text=\"取消\"\n             action=\"\"\n             :maskClosable=\"false\"\n             :afterClose=\"initTagFormData\"\n             @ok=\"addTag\"\n    >\n\n      <a-form-model\n          ref=\"ruleForm\"\n          :model=\"newTag\"\n          :rules=\"childrenModelRules\"\n          :label-col=\"{ span: 3 }\"\n          :wrapper-col=\"{ span: 20 }\"\n      >\n        <a-form-model-item ref=\"name\" label=\"内容\" prop=\"name\">\n          <a-input v-model=\"newTag.name\"/>\n        </a-form-model-item>\n        <a-form-model-item label=\"颜色\" prop=\"color\">\n          <a-input type=\"color\" v-model=\"newTag.color\"/>\n        </a-form-model-item>\n      </a-form-model>\n    </a-modal>\n  </div>\n</template>\n<script>\n\nexport default {\n  name: \"AddTag\",\n  props: {\n    openFlag: {\n      type: Boolean,\n      required: true\n    }\n  },\n  data() {\n    return {\n      loading: false, // modal按钮的loading\n      visible: false, // modal可见开关\n      childrenModelRules: {\n        name: [\n          {required: true, message: '请输入标签内容', trigger: 'blur'},\n          {min: 1, max: 20, message: '长度必须在 1 ～ 20', trigger: 'blur'},\n        ],\n      },// 子modal的校验规则\n      newTag: {\n        name: \"\",\n        color: '#61afd1'\n      }, // 新标签的form modal中的默认值\n    };\n  },\n  watch: {\n    openFlag: {\n      handler: function (newVal, oldVal) {\n        this.visible = newVal\n      },\n      // 深度观察监听\n      deep: true\n    },\n  },\n  mounted() {\n    this.visible = this.openFlag\n  },\n  methods: {\n\n    // 添加一个新标签的请求\n    addTag() {\n      this.$refs.ruleForm.validate(valid => {\n        if (valid) {\n          var data = {\n            data: this.newTag\n          }\n          this.$request.postTags(data).then(res => {\n            if (res.status === 200) {\n              this.$message.success(\"添加标签成功\")\n              // 请求成功后 将新的数据添加到tags\n              this.tags.push(res.data.data[0])\n            } else {\n              this.$message.error(\"添加标签失败\")\n            }\n          })\n          this.initTagFormData()\n          this.childrenModelVisible = false;\n        } else {\n          return false\n        }\n      });\n    },\n    // 重置添加新标签的子modal\n    initTagFormData() {\n      this.$refs.ruleForm.resetFields();\n    },\n\n    /*\n      向父组件传值：组件状态\n     */\n    handleCancel(e) {\n      this.initTagFormData()\n      this.$emit('updateModelStatus', false)\n    },\n    afterClose(e) {\n      this.initTagFormData()\n      this.$emit('updateModelStatus', false)\n    },\n  },\n};\n</script>\n<style scoped>\n.color-box {\n  width: 12px;\n  height: 12px;\n  align-items: center;\n  margin: 0 5px 0 0;\n  display: inline-block;\n}\n\n/deep/ .anticon .anticon-exclamation-circle {\n  display: none !important;\n}\n/deep/ .ant-modal-body{\n  max-height: 400px;\n  overflow-y: auto;\n}\n\n.dynamic-delete-button {\n  cursor: pointer;\n  position: relative;\n  top: 4px;\n  font-size: 24px;\n  color: #999;\n  transition: all 0.3s;\n}\n.dynamic-delete-button:hover {\n  color: #777;\n}\n.dynamic-delete-button[disabled] {\n  cursor: not-allowed;\n  opacity: 0.5;\n}\n\n</style>\n"],"mappings":";AAgCA;EACAA,IAAA;EACAC,KAAA;IACAC,QAAA;MACAC,IAAA,EAAAC,OAAA;MACAC,QAAA;IACA;EACA;EACAC,KAAA;IACA;MACAC,OAAA;MAAA;MACAC,OAAA;MAAA;MACAC,kBAAA;QACAT,IAAA,GACA;UAAAK,QAAA;UAAAK,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA;MAEA;MAAA;MACAG,MAAA;QACAd,IAAA;QACAe,KAAA;MACA;IACA;EACA;;EACAC,KAAA;IACAd,QAAA;MACAe,OAAA,WAAAA,CAAAC,MAAA,EAAAC,MAAA;QACA,KAAAX,OAAA,GAAAU,MAAA;MACA;MACA;MACAE,IAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAb,OAAA,QAAAN,QAAA;EACA;EACAoB,OAAA;IAEA;IACAC,OAAA;MACA,KAAAC,KAAA,CAAAC,QAAA,CAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,IAAArB,IAAA;YACAA,IAAA,OAAAQ;UACA;UACA,KAAAc,QAAA,CAAAC,QAAA,CAAAvB,IAAA,EAAAwB,IAAA,CAAAC,GAAA;YACA,IAAAA,GAAA,CAAAC,MAAA;cACA,KAAAC,QAAA,CAAAC,OAAA;cACA;cACA,KAAAC,IAAA,CAAAC,IAAA,CAAAL,GAAA,CAAAzB,IAAA,CAAAA,IAAA;YACA;cACA,KAAA2B,QAAA,CAAAI,KAAA;YACA;UACA;UACA,KAAAC,eAAA;UACA,KAAAC,oBAAA;QACA;UACA;QACA;MACA;IACA;IACA;IACAD,gBAAA;MACA,KAAAd,KAAA,CAAAC,QAAA,CAAAe,WAAA;IACA;IAEA;AACA;AACA;IACAC,aAAAC,CAAA;MACA,KAAAJ,eAAA;MACA,KAAAK,KAAA;IACA;IACAC,WAAAF,CAAA;MACA,KAAAJ,eAAA;MACA,KAAAK,KAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}